<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shubh Shah | Projects</title>
  <meta name="description" content="Explore Shubh Shah's projects, showcasing innovative data analytics and business intelligence solutions.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <!-- Navbar (Updated with Auto Mode Button) -->
  <header class="navbar" role="banner">
    <div class="nav-content">
      <div class="logo">MyPortfolio</div>
      <nav class="menu" role="navigation">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="projects.html" class="active">Projects</a>
        <a href="contact.html">Contact</a>
      </nav>
      <div class="theme-controls">
        <label class="switch">
          <input type="checkbox" id="darkModeToggle" aria-label="Toggle dark mode">
          <span class="slider round"></span>
        </label>
        <button id="autoModeToggle" class="auto-switch">Auto</button>
      </div>
    </div>
  </header>

  <!-- Hero Section (Enhanced with Project Focus) -->
  <section class="hero-section">
    <div class="hero-container">
      <h1>My Data Analytics Projects</h1>
      <h3>Discover Innovative Solutions in EV Adoption, Sales, Obesity Trends, and More</h3>
      <p>Explore my portfolio of projects built with SQL, Python, Tableau, Power BI, and Machine Learning to drive impactful insights.</p>
      <div class="hero-buttons">
        <button onclick="scrollToProjects()">View Projects</button>
        <button onclick="window.open('assets/files/RESUME_2025.pdf', '_blank')">Download Resume</button>
      </div>
    </div>
  </section>

  <!-- Projects Section (Enhanced Layout and Sorting) -->
  <section class="page-section projects-section">
    <h2>Explore My Projects</h2>
    <div class="project-controls" style="margin-bottom: 2rem; text-align: center;">
      <label for="sortSelect">Sort By:</label>
      <select id="sortSelect" onchange="sortProjects()">
        <option value="date">Date (Newest First)</option>
        <option value="title">Title (A-Z)</option>
      </select>
      <button id="filterBtn" onclick="filterProjects()">Filter by Category</button>
    </div>
    <div id="projectCardsContainer" class="projects-grid enhanced-grid">
      <!-- Cards loaded dynamically from projects.json -->
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer" role="contentinfo">
    <p>© 2025 Shubh Shah | <a href="https://github.com/sshah2000" target="_blank">GitHub</a> | 
    <a href="https://www.linkedin.com/in/shubh-shah-054463211" target="_blank">LinkedIn</a> | 
    <a href="/cdn-cgi/l/email-protection#c3b0abb6a1abb0aba2abf1f3f3f383baa2abacaceda0acae">Email</a></p>
  </footer>

  <!-- Modal for Project Details -->
  <div id="projectModal" class="modal">
    <div class="modal-content">
      <button class="close-btn" id="modalCloseBtn">×</button>
      <div id="projectReport" class="report-section"></div>
    </div>
  </div>

  <!-- JavaScript to Load Projects, Handle Sorting, Navigation, and Modal -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      loadProjects();
    });

    async function loadProjects() {
      try {
        const response = await fetch('assets/projects.json');
        if (!response.ok) throw new Error('Network response was not ok');
        const projects = await response.json();
        window.projectData = projects.filter((project, index, self) =>
          index === self.findIndex((p) => p.id === p.id)
        );
        window.projectData.sort((a, b) => new Date(b.date) - new Date(a.date));
        renderProjectCards(window.projectData);
      } catch (error) {
        console.error('Error loading projects:', error);
        document.getElementById('projectCardsContainer').innerHTML = '<p>Unable to load projects. Please try again later.</p>';
      }
    }

    function renderProjectCards(projects) {
      const container = document.getElementById('projectCardsContainer');
      if (!container) return;
      container.innerHTML = '';
      projects.forEach(project => {
        const card = document.createElement('div');
        card.className = 'project-card enhanced-card';
        card.id = `project-${project.id}`;
        card.innerHTML = `
          <img src="${project.thumbnail || 'assets/images/default.png'}" alt="${project.title} Thumbnail" class="thumbnail">
          <div class="card-content">
            <h3>${project.title}</h3>
            <p><strong>Date:</strong> ${project.date}</p>
            <p><strong>Category:</strong> ${project.overview?.category || 'Uncategorized'}</p>
            <p>${(project.description || 'No description available.').substring(0, 100)}...</p>
          </div>
        `;
        card.addEventListener('click', () => openModal(project));
        container.appendChild(card);
      });
      checkHashNavigation();
    }

    function openModal(project) {
      const modal = document.getElementById('projectModal');
      const report = document.getElementById('projectReport');
      if (!modal || !report) return;
      report.innerHTML = `
        <h2 style="text-align:center; text-decoration:underline; margin-bottom:1rem;">${project.title}</h2>
        <p style="text-align:center; margin-bottom:1rem;"><strong>Date:</strong> ${project.date}</p>
        <h3 style="text-decoration:underline; margin-top:1rem;">Description</h3>
        <div style="margin-left:1rem;">${project.description || 'No description available.'}</div>
        <h3 style="text-decoration:underline; margin-top:1rem;">Methodology</h3>
        <div style="margin-left:1rem;">${project.methodology || 'N/A'}</div>
        <h3 style="text-decoration:underline; margin-top:1rem;">Technologies</h3>
        ${project.technologies?.length ? `<ul style="margin-left:2rem;">${project.technologies.map(t => `<li>${t}</li>`).join('')}</ul>` : '<p style="margin-left:1rem;">No technologies listed.</p>'}
        <h3 style="text-decoration:underline; margin-top:1rem;">Story / Background</h3>
        <div style="margin-left:1rem;">${project.overview?.story || 'N/A'}</div>
        <h3 style="text-decoration:underline; margin-top:1rem;">Collected Data</h3>
        <div style="margin-left:1rem;">${project.overview?.collectedData || 'N/A'}</div>
        <h3 style="text-decoration:underline; margin-top:1rem;">Conclusions</h3>
        <div style="margin-left:1rem;">${project.overview?.conclusions || 'N/A'}</div>
        ${project.reportPdf ? `<p style="margin-top:1rem;"><strong>Project Report:</strong> <a href="${project.reportPdf}" target="_blank">View Report</a></p>` : '<p style="margin-top:1rem;"><strong>Project Report:</strong> None available.</p>'}
        ${project.resources?.length ? `
          <div style="margin-top:1rem;">
            <h3 style="text-decoration:underline;">Additional Resources</h3>
            <ul style="margin-left:1rem;">
              ${project.resources.map(r => `<li><strong>${r.name}</strong> (${r.category}) – <a href="${r.file_path}" target="_blank">View / Download</a></li>`).join('')}
            </ul>
          </div>` : '<p style="margin-top:1rem;"><strong>Additional Resources:</strong> None available.</p>'}
      `;
      modal.style.display = 'flex';
    }

    function closeModal() {
      const modal = document.getElementById('projectModal');
      if (modal) modal.style.display = 'none';
    }

    // Close modal when clicking outside or on close button
    document.getElementById('modalCloseBtn')?.addEventListener('click', closeModal);
    window.addEventListener('click', (e) => {
      const modal = document.getElementById('projectModal');
      if (e.target === modal) closeModal();
    });

    function checkHashNavigation() {
      const hash = window.location.hash.substring(1);
      if (hash) {
        const projectId = parseInt(hash, 10);
        const targetProject = window.projectData.find(p => p.id === projectId);
        if (targetProject) openModal(targetProject);
      }
    }

    function sortProjects() {
      const sortSelect = document.getElementById('sortSelect');
      const sortValue = sortSelect.value;
      let sortedProjects = [...window.projectData];
      if (!sortedProjects || sortedProjects.length === 0) {
        loadProjects();
        return;
      }
      if (sortValue === 'date') {
        sortedProjects.sort((a, b) => new Date(b.date) - new Date(a.date));
      } else if (sortValue === 'title') {
        sortedProjects.sort((a, b) => a.title.localeCompare(b.title));
      }
      renderProjectCards(sortedProjects);
    }

    window.sortProjects = sortProjects;

    function scrollToProjects() {
      document.querySelector('.projects-section').scrollIntoView({ behavior: 'smooth' });
    }

    function filterProjects() {
      // Placeholder for filtering by category (can be enhanced with a modal or dropdown)
      alert('Filter by category functionality to be implemented. Current categories: ' + window.projectData.map(p => p.overview?.category || 'Uncategorized').join(', '));
    }
  </script>
</body>
</html>